import {useLazyFetch,useFetch,useAsyncData,useLazyAsyncData}from'nuxt/app';import {toValue,reactive,ref,watch,isRef,unref}from'vue';var v=async(r,t)=>{let e=typeof t=="function"?await t(r):t;if(e)return r.scheme==="bearer"?`Bearer ${e}`:r.scheme==="basic"?`Basic ${btoa(e)}`:e},U=(r,t,e)=>{typeof e=="string"||e instanceof Blob?r.append(t,e):r.append(t,JSON.stringify(e));},k=(r,t,e)=>{typeof e=="string"?r.append(t,e):r.append(t,JSON.stringify(e));},F={bodySerializer:r=>{let t=new FormData;return Object.entries(r).forEach(([e,n])=>{n!=null&&(Array.isArray(n)?n.forEach(o=>U(t,e,o)):U(t,e,n));}),t}},R={bodySerializer:r=>JSON.stringify(r,(t,e)=>typeof e=="bigint"?e.toString():e)},I={bodySerializer:r=>{let t=new URLSearchParams;return Object.entries(r).forEach(([e,n])=>{n!=null&&(Array.isArray(n)?n.forEach(o=>k(t,e,o)):k(t,e,n));}),t.toString()}},N=r=>{switch(r){case "label":return ".";case "matrix":return ";";case "simple":return ",";default:return "&"}},Q=r=>{switch(r){case "form":return ",";case "pipeDelimited":return "|";case "spaceDelimited":return "%20";default:return ","}},V=r=>{switch(r){case "label":return ".";case "matrix":return ";";case "simple":return ",";default:return "&"}},S=({allowReserved:r,explode:t,name:e,style:n,value:o})=>{if(!t){let i=(r?o:o.map(u=>encodeURIComponent(u))).join(Q(n));switch(n){case "label":return `.${i}`;case "matrix":return `;${e}=${i}`;case "simple":return i;default:return `${e}=${i}`}}let a=N(n),s=o.map(i=>n==="label"||n==="simple"?r?i:encodeURIComponent(i):p({allowReserved:r,name:e,value:i})).join(a);return n==="label"||n==="matrix"?a+s:s},p=({allowReserved:r,name:t,value:e})=>{if(e==null)return "";if(typeof e=="object")throw new Error("Deeply-nested arrays/objects aren\u2019t supported. Provide your own `querySerializer()` to handle these.");return `${t}=${r?e:encodeURIComponent(e)}`},z=({allowReserved:r,explode:t,name:e,style:n,value:o})=>{if(o instanceof Date)return `${e}=${o.toISOString()}`;if(n!=="deepObject"&&!t){let i=[];Object.entries(o).forEach(([l,d])=>{i=[...i,l,r?d:encodeURIComponent(d)];});let u=i.join(",");switch(n){case "form":return `${e}=${u}`;case "label":return `.${u}`;case "matrix":return `;${e}=${u}`;default:return u}}let a=V(n),s=Object.entries(o).map(([i,u])=>p({allowReserved:r,name:n==="deepObject"?`${e}[${i}]`:i,value:u})).join(a);return n==="label"||n==="matrix"?a+s:s};var W=/\{[^{}]+\}/g,J=({path:r,url:t})=>{let e=t,n=t.match(W);if(n)for(let o of n){let a=false,s=o.substring(1,o.length-1),i="simple";s.endsWith("*")&&(a=true,s=s.substring(0,s.length-1)),s.startsWith(".")?(s=s.substring(1),i="label"):s.startsWith(";")&&(s=s.substring(1),i="matrix");let u=toValue(toValue(r)[s]);if(u==null)continue;if(Array.isArray(u)){e=e.replace(o,S({explode:a,name:s,style:i,value:u}));continue}if(typeof u=="object"){e=e.replace(o,z({explode:a,name:s,style:i,value:u}));continue}if(i==="matrix"){e=e.replace(o,`;${p({name:s,value:u})}`);continue}let l=encodeURIComponent(i==="label"?`.${u}`:u);e=e.replace(o,l);}return e},E=({allowReserved:r,array:t,object:e}={})=>o=>{let a=[],s=toValue(o);if(s&&typeof s=="object")for(let i in s){let u=toValue(s[i]);if(u!=null)if(Array.isArray(u)){let l=S({allowReserved:r,explode:true,name:i,style:"form",value:u,...t});l&&a.push(l);}else if(typeof u=="object"){let l=z({allowReserved:r,explode:true,name:i,style:"deepObject",value:u,...e});l&&a.push(l);}else {let l=p({allowReserved:r,name:i,value:u});l&&a.push(l);}}return a.join("&")},B=async({security:r,...t})=>{for(let e of r){let n=await v(e,t.auth);if(!n)continue;let o=e.name??"Authorization";switch(e.in){case "query":t.query||(t.query={}),toValue(t.query)[o]=n;break;case "cookie":t.headers.append("Cookie",`${o}=${n}`);break;case "header":default:t.headers.set(o,n);break}return}},m=r=>M({baseUrl:r.baseURL,path:r.path,query:r.query,querySerializer:typeof r.querySerializer=="function"?r.querySerializer:E(r.querySerializer),url:r.url}),M=({baseUrl:r,path:t,query:e,querySerializer:n,url:o})=>{let a=o.startsWith("/")?o:`/${o}`,s=(r??"")+a;t&&(s=J({path:t,url:s}));let i=e?n(e):"";return i.startsWith("?")&&(i=i.substring(1)),i&&(s+=`?${i}`),s},x=(r,t)=>{let e={...r,...t};return e.baseURL?.endsWith("/")&&(e.baseURL=e.baseURL.substring(0,e.baseURL.length-1)),e.headers=O(r.headers,t.headers),e},O=(...r)=>{let t=new Headers;for(let e of r){if(!e||typeof e!="object")continue;let n=e;isRef(n)&&(n=unref(n));let o=n instanceof Headers?n.entries():Object.entries(n);for(let[a,s]of o)if(s===null)t.delete(a);else if(Array.isArray(s))for(let i of s)t.append(a,y(i));else if(s!==void 0){let i=y(s);t.set(a,typeof i=="object"?JSON.stringify(i):i);}}return t},q=(...r)=>r.reduce((t,e)=>{if(typeof e=="function")t.push(e);else if(Array.isArray(e))return t.concat(e);return t},[]),_=E({allowReserved:false,array:{explode:true,style:"form"},object:{explode:true,style:"deepObject"}}),K={"Content-Type":"application/json"},w=(r={})=>({...R,headers:K,querySerializer:_,...r}),y=r=>{if(r===null||typeof r!="object"||r instanceof Headers)return isRef(r)?unref(r):r;if(Array.isArray(r))return r.map(e=>y(e));if(isRef(r))return y(unref(r));let t={};for(let e in r)t[e]=y(r[e]);return t},g=r=>r.body&&r.bodySerializer?r.bodySerializer(r.body):r.body,P=(r,t)=>{let e=y(r);return e.body=g(e),t(m(r),e)};var re=(r={})=>{let t=x(w(),r),e=()=>({...t}),n=a=>(t=x(t,a),e()),o=({asyncDataOptions:a,composable:s,key:i,...u})=>{let l={...t,...u,$fetch:u.$fetch??t.$fetch??$fetch,headers:O(t.headers,u.headers),onRequest:q(t.onRequest,u.onRequest),onResponse:q(t.onResponse,u.onResponse)},{responseTransformer:d,responseValidator:C,security:j}=l;j&&(l.onRequest=[async({options:c})=>{await B({auth:l.auth,headers:c.headers,query:c.query,security:j});},...l.onRequest]),(d||C)&&(l.onResponse=[...l.onResponse,async({options:c,response:f})=>{c.responseType&&c.responseType!=="json"||f.ok&&(C&&await C(f._data),d&&(f._data=await d(f._data)));}]),(l.body===void 0||l.body==="")&&l.headers.delete("Content-Type");let $=l.$fetch;if(s==="$fetch")return P(l,$);if(s==="useFetch"||s==="useLazyFetch"){let c=reactive({body:l.body,bodySerializer:l.bodySerializer}),f=ref(g(l));return l.body=f,watch(c,D=>{f.value=g(D);}),s==="useLazyFetch"?useLazyFetch(()=>m(l),l):useFetch(()=>m(l),l)}let b=()=>P(l,$);if(s==="useAsyncData")return i?useAsyncData(i,b,a):useAsyncData(b,a);if(s==="useLazyAsyncData")return i?useLazyAsyncData(i,b,a):useLazyAsyncData(b,a)};return {buildUrl:m,connect:a=>o({...a,method:"CONNECT"}),delete:a=>o({...a,method:"DELETE"}),get:a=>o({...a,method:"GET"}),getConfig:e,head:a=>o({...a,method:"HEAD"}),options:a=>o({...a,method:"OPTIONS"}),patch:a=>o({...a,method:"PATCH"}),post:a=>o({...a,method:"POST"}),put:a=>o({...a,method:"PUT"}),request:o,setConfig:n,trace:a=>o({...a,method:"TRACE"})}};export{re as createClient,w as createConfig,F as formDataBodySerializer,R as jsonBodySerializer,I as urlSearchParamsBodySerializer};//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map